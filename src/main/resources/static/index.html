<!DOCTYPE html>
<html>
<head>
    <title>Live Trade Feed</title>
    <style>
        body {
            font-family: sans-serif;
            background-color: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
        }
        #feed {
            border: 1px solid #444;
            padding: 10px;
            height: 80vh;
            overflow-y: scroll;
            font-size: 0.9em;
            margin-top: 20px;
        }
        .trade {
            padding: 5px;
            border-bottom: 1px solid #333;
        }
        .buy {
            color: #4ec9b0;
        }
        .sell {
            color: #f44747;
        }
    </style>
</head>
<body>
<h1>Live Trade Feed</h1>
<div id="feed">Connecting to trade stream...</div>

<script>
    const feed = document.getElementById('feed');
    const eventSource = new EventSource('/trades/stream');

    eventSource.onopen = () => {
        feed.innerHTML = "";
    };

    eventSource.addEventListener('trade', event => {
        const trade = JSON.parse(event.data);
        const tradeElement = document.createElement('div');
        tradeElement.className = 'trade';
        // A simple heuristic to determine the aggressor side for coloring
        const side = trade.buyOrderId > trade.sellOrderId ? 'BUY' : 'SELL';
        tradeElement.classList.add(side.toLowerCase());
        tradeElement.textContent = `${side} ${trade.quantity} ${trade.stockSymbol} @ ${trade.price}`;
        feed.prepend(tradeElement);
    });

    eventSource.onerror = err => {
        feed.textContent = 'Connection to server lost. Please refresh the page.';
    };
</script>
</body>
</html>